<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
   <title>Get your GIF on!</title>
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


   

   <!-- <link rel="stylesheet" type="text/css" href= "asset/css/style.css"> -->

</head>
<body>
        <div class="container">
            <div class ="row">
                <div class="col-12">
                <h1>GIF and Take</h1>
            </div>

            </div>
                <!-- Rendered Buttons will get Dumped Here  -->
                <div id="buttons-view"></div>
            
                <form id="gif-form">
                  <label for="gif-input">GIF for IT!</label>
                  <input type="text" id="gif-input">
                  <br>
            
                  <!-- Button triggers new gif to be added -->
                  <input id="add-gif" type="submit" value="GIF-ETH!!">
                </form>
            
                <!-- gifs will Get Dumped Here -->
                <div id="gif-view"></div>
    <!-- Input Form -->
    <!-- <form>
            <span id="search-bar">Giphy search <input id="user-search" type="text" ><input id="search-button" value="Have Fun!" type="submit"></span>
          </form> -->
       
          <hr>


   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

    var gif="";
     
      var topics =["Joy","Excitement","Surprise","Sadness","Anger","Disgust","Contempt","Fear"]

      // displaygifInfo function re-renders the HTML to display the appropriate content
      function displayGifInfo() {
          $("#gif-view").empty();

        var query = $(this).attr("data-name");
        //console.log("query is " + query);
        var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + query + "&api_key=ttW7fYuN6GCKvPWa0Vn5T0Lox99zjQT2&limit=10&rating=pg-13";

  
        $.ajax({
          url: queryURL,
          method: "GET"
        }).then(function(response) {
          console.log(response.data.url);
          gif=response.data;
          console.log(gif);
          populateGif();       
        });

      }

      // Function for displaying movie data
      function renderButtons() {
        $("#buttons-view").empty();
   // Looping through the array of movies
        for (var i = 0; i < topics.length; i++) {
          var a = $("<button>");
          a.addClass("gif-btn");
          a.attr("data-name", topics[i]);
          a.append(topics[i]);
          $("#buttons-view").append(a);
        }
      }

      function populateGif() {
        $("#gif-view").empty();
        // Looping through the array of gifs from Response
        for (var i = 0; i < gif.length; i++) {
            
            var gifDiv = $("<div class='gif'>");
             gifDiv.addClass('gif col-xs-12 col-md-4 ');
             gifDiv.attr("data-name", gif[i]);
             gifDiv.append('<img class="gifStill" src='+gif[i].images.fixed_height_still.url + ' data-still=' + gif[i].images.fixed_height_still.url + ' data-animate=' + gif[i].images.fixed_height.url + ' data-state="still"/>');
        
             gifDiv.append('<span class="label label-default">Rated: '+gif[i].rating.toUpperCase() + '</span>');
             $("#gif-view").append(gifDiv);
        
        }
      };



      // This function handles events where a movie button is clicked
      $("#add-gif").on("click", function(event) {
        event.preventDefault();
        // This line grabs the input from the textbox
        var gifTopic = $("#gif-input").val().trim();
        console.log("this is gifTopic " + gifTopic);

        // Adding gif category from the textbox to our array
        topics.push(gifTopic);

        // Calling renderButtons which handles the processing of our movie array
        renderButtons();
        displayGifInfo();
      });

      // Adding a click event listener to all elements with a class of "movie-btn"
      $(document).on("click", ".gif-btn", displayGifInfo);

      renderButtons();


// GIF will animate if clicked

    $(document).on('click','.gifStill', function(){
        var state = $(this).data('state')
            if (state === 'still') {
                $(this).attr('src', $(this).attr('data-animate'));
                $(this).data('state', 'animate');
             }
            if (state === 'animate') {
                 $(this).attr('src', $(this).attr('data-still'));
                $(this).data('state', 'still');
             }
});





      
    </script>
     
  </div>
</body>

</html>

